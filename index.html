<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestão de Recolhas - Kovi</title>
  <link rel="icon" type="image/png" href="https://i.ibb.co/ksMQSMQ2/web-app-manifest-192x192.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@800&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/timezone.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/utc.js"></script>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/animations/scale.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <style>
    :root {
      --primary-color: #FF355A;
      --primary-color-darker: #E02E4D;
      --scrollbar-track: #f1f1f1;
      --scrollbar-thumb: #c1c1c1;
    }
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f7f9fa;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: background 0.3s;
    }
    .bg-primary { background-color: var(--primary-color); }
    .text-primary { color: var(--primary-color); }
    .border-primary { border-color: var(--primary-color); }
    .btn-primary { background-color: var(--primary-color); color: white; transition: background 0.2s; }
    .btn-primary:hover { background-color: var(--primary-color-darker); }
    .focus-primary:focus { border-color: var(--primary-color) !important; box-shadow: 0 0 0 2px rgba(255, 53, 90, 0.4) !important; }
    .sidebar { background: #fff; border-right: 1px solid #eee; }
    .sidebar .active { background: var(--primary-color); color: #fff; }
    .sidebar .nav-btn { transition: background 0.2s, color 0.2s; }
    .sidebar .nav-btn:hover { background: #ffe5ea; color: var(--primary-color); }
    .topbar { background: #fff; border-bottom: 1px solid #eee; }
    .kanban-card { transition: box-shadow 0.2s, border 0.2s; }
    .kanban-card:hover { box-shadow: 0 4px 24px rgba(255,53,90,0.08); border-color: var(--primary-color); }
    .blink { animation: blink 1s linear infinite; }
    @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.2; } }
    .dark body { background: #18181b; color: #f3f4f6; }
    .dark .sidebar, .dark .topbar { background: #23232a; border-color: #333; }
    .dark .kanban-card { background: #23232a; border-color: #333; }
    .dark .table-list-item { background: #23232a; }
    .dark .btn-primary { background: var(--primary-color-darker); }
    .dark .btn-primary:hover { background: var(--primary-color); }
    .skeleton { background: linear-gradient(90deg, #f3f3f3 25%, #ecebeb 50%, #f3f3f3 75%); background-size: 200% 100%; animation: skeleton 1.2s infinite linear; }
    @keyframes skeleton { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    .tippy-box[data-theme~='kovi'] { background: var(--primary-color); color: #fff; }
    .toastify { font-size: 0.95rem; }
    .scrollbar-thin::-webkit-scrollbar { width: 6px; }
    .scrollbar-thin::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 4px; }
    .scrollbar-thin::-webkit-scrollbar-track { background: var(--scrollbar-track); }
    .export-btn { background: #fff; border: 1px solid var(--primary-color); color: var(--primary-color); transition: background 0.2s, color 0.2s; }
    .export-btn:hover { background: var(--primary-color); color: #fff; }
    .tab-btn.active { border-bottom: 2px solid var(--primary-color); color: var(--primary-color); }
    .tab-btn { transition: color 0.2s, border 0.2s; }
    .dark .tab-btn.active { color: #fff; border-bottom: 2px solid #fff; }
    .dark .tab-btn { color: #f3f4f6; }
    .dark .export-btn { background: #23232a; color: var(--primary-color); border-color: var(--primary-color); }
    .dark .export-btn:hover { background: var(--primary-color); color: #fff; }
  </style>
</head>
<body class="text-gray-800">
  <div class="flex h-screen">
    <!-- Sidebar -->
    <aside class="sidebar w-64 flex flex-col py-6 px-4">
      <div class="flex items-center gap-3 mb-8">
        <img src="https://i.ibb.co/zh6PNsYs/kovi-logo-fundo-rosa.png" alt="Logo Kovi" class="h-10">
        <span class="text-primary font-extrabold text-lg" style="font-family: 'Poppins', sans-serif;">Gestão de Recolhas</span>
      </div>
      <nav class="flex flex-col gap-2">
        <button class="nav-btn tab-btn active flex items-center gap-2 px-4 py-2 rounded-md text-base font-medium" data-tab="kanban">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M9 3v18"/><path d="M15 3v18"/></svg>
          Kanban
        </button>
        <button class="nav-btn tab-btn flex items-center gap-2 px-4 py-2 rounded-md text-base font-medium" data-tab="list">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg>
          Lista
        </button>
        <button class="nav-btn tab-btn flex items-center gap-2 px-4 py-2 rounded-md text-base font-medium" data-tab="dashboard">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M3 13h2v-2H3v2zm4 0h2v-2H7v2zm4 0h2v-2h-2v2zm4 0h2v-2h-2v2zm4 0h2v-2h-2v2z"/><path d="M5 7h14M5 17h14"/></svg>
          Visão Geral
        </button>
      </nav>
      <div class="mt-auto flex flex-col gap-2">
        <button id="darkModeToggle" class="flex items-center gap-2 px-4 py-2 rounded-md text-base font-medium border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 transition">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M12 3v1m0 16v1m8.66-13.66l-.71.71M4.05 19.95l-.71.71M21 12h-1M4 12H3m16.66 5.66l-.71-.71M4.05 4.05l-.71-.71"/><circle cx="12" cy="12" r="5"/></svg>
          Modo Escuro
        </button>
        <button id="logout-btn" class="flex items-center gap-2 px-4 py-2 rounded-md text-base font-medium btn-primary">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M17 16l4-4m0 0l-4-4m4 4H7"/><path d="M3 12a9 9 0 0118 0 9 9 0 01-18 0z"/></svg>
          Sair
        </button>
      </div>
    </aside>
    <!-- Main Content -->
    <div class="flex-1 flex flex-col min-w-0">
      <!-- Topbar -->
      <header class="topbar flex items-center justify-between px-8 py-4">
        <div class="flex items-center gap-4">
          <div id="user-avatar" class="h-10 w-10 rounded-full bg-gray-200 overflow-hidden flex items-center justify-center">
            <img src="https://placehold.co/40x40/FFFFFF/FF355A?text=K" alt="Foto do Perfil" class="h-10 w-10 object-cover" id="user-avatar-img">
          </div>
          <div>
            <p id="user-name" class="font-bold text-base">Utilizador Kovi</p>
            <p id="user-email" class="text-xs text-gray-500">A carregar...</p>
          </div>
        </div>
        <div class="flex items-center gap-4">
          <div id="status-indicator" class="flex items-center gap-2 text-xs text-gray-500">
            <span class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></span>
            Atualizado agora
          </div>
          <div class="relative">
            <input type="search" id="searchInput" placeholder="Procurar cards... (Ctrl+K)" class="w-64 p-2 pl-10 text-sm border border-gray-300 rounded-md focus-primary bg-white dark:bg-gray-800 dark:text-gray-100">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
          </div>
        </div>
      </header>
      <!-- Tabs -->
      <main class="flex-1 flex flex-col min-w-0 overflow-hidden">
        <div class="flex-1 flex flex-col min-w-0">
          <!-- Kanban View -->
          <section id="kanban-view" class="tab-content flex-1 flex overflow-x-auto overflow-y-hidden kanban-board p-4 scrollbar-thin"></section>
          <!-- List View -->
          <section id="list-view" class="tab-content h-full w-full p-4 hidden"></section>
          <!-- Dashboard View -->
          <section id="dashboard-view" class="tab-content h-full w-full p-4 hidden"></section>
        </div>
      </main>
    </div>
  </div>
  <!-- Modal de Detalhes -->
  <div id="cardModal" class="modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
    <div class="modal-panel bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-4xl transform scale-95 opacity-0 transition-all">
      <div class="flex justify-between items-center p-4 border-b dark:border-gray-700">
        <h3 class="text-xl font-bold" id="modalPlaca"></h3>
        <button id="closeCardModal" class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
      </div>
      <div class="flex flex-col md:flex-row">
        <div class="flex-1 p-4 overflow-y-auto">
          <div id="modal-tabs" class="flex gap-4 mb-4">
            <button class="tab-btn active" data-tab="detalhes">Detalhes</button>
            <button class="tab-btn" data-tab="historico">Histórico</button>
            <button class="tab-btn" data-tab="acoes">Ações Rápidas</button>
          </div>
          <div id="modal-content-detalhes"></div>
          <div id="modal-content-historico" class="hidden"></div>
          <div id="modal-content-acoes" class="hidden"></div>
        </div>
      </div>
    </div>
  </div>
  <!-- Toast Container -->
  <div id="toast-container"></div>
  <script src="app.js"></script>
</body>
</html>
